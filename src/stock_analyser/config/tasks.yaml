researcher_task:
  description: >
    Conduct broad market research for ticker symbol {name} using the assigned LLM's capabilities and web search to uncover general news, developments,
    analyst ratings, future price predictions, potential risks, and insights into major shareholders, institutional investors, and insiders.
    This task focuses on gathering qualitative information and market context that complements the detailed quantitative analyses provided by other specialized agents.
    The current year is {current_year}.
  expected_output: >
    A comprehensive report with 40 bullet points detailing the most relevant fundamental and market information about ticker symbol {name}, including structured financial data and a summary of the company's financial health. If certain financial data is unavailable from tools, focus on other available information to provide the most complete report possible.
  agent: researcher

reporter_task:
  description: >
    Review all the context you got from other agents. Your primary goal is to synthesize this information into a comprehensive, easy-to-understand stock analysis report for a non-expert audience. This means:
    - Explain all technical indicators (SMA, EMA, RSI, MACD, Bollinger Bands, Ichimoku Cloud, Fibonacci Retracements, ATR) in simple, clear language.
    - Write for a general audience. Avoid jargon and buzzwords whenever possible; if you must use them, define them immediately in plain English.
    - For each technical indicator, include a "Plain-English takeaway" that tells a non-expert what the indicator suggests and why it matters.
    - Focus on the practical implications and investment insights derived from these indicators, rather than just presenting raw data.
    - Structure the report logically with clear headings and a natural flow, avoiding jargon where possible or explaining it thoroughly.
    - Summarize key findings and recommendations in an accessible manner.
    Make sure the report is detailed and contains any and all relevant information.
  expected_output: >
    A fully fledged report with the main topics, each with a full section of information. The report MUST be easy to read and understand for a general audience, with all complex financial terms and technical indicators clearly explained. The report MUST include relevant charts and graphs (at least historical prices, MACD, and RSI) generated using the visualization tools (plot_stock_prices, plot_macd, plot_rsi) to illustrate technical analysis findings. Charts should be embedded as base64 encoded images within the markdown report using the format: ![Short caption](data:image/png;base64,ENCODED_STRING). Add a 1-2 sentence plain-English caption explaining what the reader should notice.
    Formatted as markdown without '```'
  context:
    - researcher_task
    - sentiment_analysis_task
    - technical_analyst_task
    - chart_pattern_analysis_task
    - fundamental_analysis_task
  markdown: true
  agent: reporter

chart_pattern_analysis_task:
  description: >
    Analyze historical price charts for {name} to identify significant chart patterns
    such as support and resistance levels, head and shoulders, double tops/bottoms,
    and triangles. Interpret these patterns for potential future price movements and provide insights.
    The current year is {current_year}.
  expected_output: >
    A detailed analysis of identified chart patterns for {name}, including descriptions of patterns,
    their implications for price action, and potential trading signals.
    If historical prices are unavailable from tools, the chart pattern analysis section should be omitted or briefly state that this analysis could not be performed without sufficient data, without detailing the source of unavailability.
    Formatted as markdown without '```'
  agent: technical_analyst

fundamental_analysis_task:
  description: >
    Perform a deep fundamental analysis for ticker symbol {name}.
    Retrieve comprehensive financial statements (income statement, balance sheet, cash flow statement) for the last 2 years
    using the Finnhub API. Calculate and interpret key financial ratios such as P/E ratio, EPS, Debt-to-Equity,
    Current Ratio, and Return on Equity. Provide an overall assessment of the company's financial health and intrinsic value.
    The current year is {current_year}.
  expected_output: >
    A detailed fundamental analysis report for {name}, including:
    - Summaries of key financial statements.
    - Calculated and interpreted financial ratios.
    - An overall assessment of financial health, intrinsic value, and long-term investment potential.
    If Finnhub data for financial statements or metrics is unavailable from tools, omit the specific unavailable details and provide a general qualitative assessment if sufficient information is available from other sources.
    Formatted as markdown without '```'
  context:
    - researcher_task
  agent: fundamental_analyst

technical_analyst_task:
  description: >
    Perform a comprehensive technical analysis for the ticker symbol {name}.
    If Finnhub data is available, use it to retrieve historical stock prices, else use web search to find historical prices and calculate
    key technical indicators such as Moving Averages (SMA, EMA), Relative Strength Index (RSI),
    Moving Average Convergence Divergence (MACD), Bollinger Bands, Ichimoku Cloud, Fibonacci Retracements, and Average True Range (ATR).
    Interpret these indicators to identify trends, momentum, and potential buy/sell signals.
    Explain each indicator in plain English, avoiding buzzwords and defining any jargon in the same sentence.
    Focus on providing actionable insights based on the technical patterns observed.
    The current year is {current_year}.
  expected_output: >
    A detailed technical analysis report for {name}, including:
    - Current price and recent price movements.
    - Calculated values and interpretations for SMA, EMA, RSI, MACD, Bollinger Bands, Ichimoku Cloud components, Fibonacci Retracement levels, and ATR.
    - Identification of key support and resistance levels.
    - Potential bullish or bearish signals.
    - A summary of overall technical outlook and recommendations.
    - A plain-English takeaway for each indicator (1-2 sentences) that a non-expert can understand.
    If historical prices or any technical indicator calculation is unavailable from tools, omit those specific details and focus on other available analysis to provide comprehensive insights.
    Formatted as markdown without '```'
  agent: technical_analyst

sentiment_analysis_task:
  description: >
    Utilize Finnhub's news and sentiment data capabilities, and conduct broader web searches to gauge public and market sentiment towards the ticker symbol {name}.
    Gather news sentiment data using the Finnhub API and also search for additional news articles, social media discussions, and analyst opinions to gain a comprehensive understanding of the sentiment.
    Integrate all gathered sentiment data into the analysis report, identifying key trends and their potential impact.
    The current year is {current_year}.
  expected_output: >
    A concise summary of the news sentiment for {name}, including overall sentiment scores, any notable positive or negative news trends, and their potential impact on the stock.
    If news sentiment data is unavailable from tools, rely more heavily on web search results for sentiment analysis and present findings without mentioning the unavailability of the primary source.
    Formatted as markdown without '```'
  agent: sentiment_analyst
